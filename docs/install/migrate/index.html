<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel=preload as=font href=https://docs.joinsharkey.org/fonts/vendor/jost/jost-v4-latin-regular.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=https://docs.joinsharkey.org/fonts/vendor/jost/jost-v4-latin-500.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=https://docs.joinsharkey.org/fonts/vendor/jost/jost-v4-latin-700.woff2 type=font/woff2 crossorigin><script>(()=>{var t=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,e=localStorage.getItem("theme");t&&e===null&&(localStorage.setItem("theme","dark"),document.documentElement.setAttribute("data-dark-mode","")),t&&e==="dark"&&document.documentElement.setAttribute("data-dark-mode",""),e==="dark"&&document.documentElement.setAttribute("data-dark-mode","")})()</script><link rel=stylesheet href=https://docs.joinsharkey.org/main.1a7f5908b44154125eeb14871a4eb2a672952c82bfe3a1ad3ac38245d83c5b8abcb2c974855e0149e958f5412c60b94cbdbe12895caff7861fd5b1b409b1f4c1.css integrity="sha512-Gn9ZCLRBVBJe6xSHGk6ypnKVLIK/46GtOsOCRdg8W4q8ssl0hV4BSelY9UEsYLlMvb4SiVyv94Yf1bG0CbH0wQ==" crossorigin=anonymous><noscript><style>img.lazyload{display:none}</style></noscript><meta name=robots content="index, follow"><meta name=googlebot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=bingbot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><title>Migrating from another software - Sharkey Documentation</title><meta name=description content="From Misskey #Let&amp;rsquo;s say you have a working Misskey, running as user misskey from /home/misskey/misskey.
Migrating to Sharkey is the same as updating to a newer Misskey version:
sudo -u misskey -i cd misskey git remote rename origin misskey git remote add origin https://git.joinsharkey.org/Sharkey/Sharkey.git git remote update -p git checkout -b stable --track origin/stable git pull --recurse-submodules pnpm install --frozen-lockfile pnpm run build pnpm run migrate Then you can restart your service."><link rel=canonical href=https://docs.joinsharkey.org/docs/install/migrate/><meta property="og:locale" content="en_US"><meta property="og:type" content="article"><meta property="og:title" content="Migrating from another software"><meta property="og:description" content="From Misskey #Let&rsquo;s say you have a working Misskey, running as user misskey from /home/misskey/misskey.
Migrating to Sharkey is the same as updating to a newer Misskey version:
sudo -u misskey -i cd misskey git remote rename origin misskey git remote add origin https://git.joinsharkey.org/Sharkey/Sharkey.git git remote update -p git checkout -b stable --track origin/stable git pull --recurse-submodules pnpm install --frozen-lockfile pnpm run build pnpm run migrate Then you can restart your service."><meta property="og:url" content="https://docs.joinsharkey.org/docs/install/migrate/"><meta property="og:site_name" content="Sharkey Documentation"><meta property="og:image" content="https://docs.joinsharkey.org/doks.png"><meta property="og:image:alt" content="Sharkey Documentation"><meta name=twitter:card content="summary_large_image"><meta name=twitter:site content="@sharkeydocs"><meta name=twitter:creator content="@transfem-org"><meta name=twitter:title content="Migrating from another software"><meta name=twitter:description content><meta name=twitter:image content="https://docs.joinsharkey.org/doks.png"><meta name=twitter:image:alt content="Migrating from another software"><script type=application/ld+json>{"@context":"https://schema.org","@graph":[{"@type":"Organization","@id":"https://docs.joinsharkey.org/#/schema/organization/1","name":"Doks","url":"https://docs.joinsharkey.org/","sameAs":["https://twitter.com/getdoks","https://github.com/h-enk/doks"],"logo":{"@type":"ImageObject","@id":"https://docs.joinsharkey.org/#/schema/image/1","url":"https://docs.joinsharkey.org/logo-doks.png","width":512,"height":512,"caption":"Doks"},"image":{"@id":"https://docs.joinsharkey.org/#/schema/image/1"}},{"@type":"WebSite","@id":"https://docs.joinsharkey.org/#/schema/website/1","url":"https://docs.joinsharkey.org/","name":"Sharkey Documentation","description":"Documentation containing all the stuff related to Sharkey","publisher":{"@id":"https://docs.joinsharkey.org/#/schema/organization/1"}},{"@type":"WebPage","@id":"https://docs.joinsharkey.org/docs/install/migrate/","url":"https://docs.joinsharkey.org/docs/install/migrate/","name":"Migrating from another software","description":"","isPartOf":{"@id":"https://docs.joinsharkey.org/#/schema/website/1"},"about":{"@id":"https://docs.joinsharkey.org/#/schema/organization/1"},"datePublished":"0001-01-01T00:00:00CET","dateModified":"0001-01-01T00:00:00CET","breadcrumb":{"@id":"https://docs.joinsharkey.org/docs/install/migrate/#/schema/breadcrumb/1"},"primaryImageOfPage":{"@id":"https://docs.joinsharkey.org/docs/install/migrate/#/schema/image/2"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https://docs.joinsharkey.org/docs/install/migrate/"]}]},{"@type":"BreadcrumbList","@id":"https://docs.joinsharkey.org/docs/install/migrate/#/schema/breadcrumb/1","name":"Breadcrumbs","itemListElement":[{"@type":"ListItem","position":1,"item":{"@type":"WebPage","@id":"https://docs.joinsharkey.org","url":"https://docs.joinsharkey.org","name":"Home"}},{"@type":"ListItem","position":3,"item":{"@type":"WebPage","@id":"https://docs.joinsharkey.org/docs/","url":"https://docs.joinsharkey.org/docs/","name":"Docs"}},{"@type":"ListItem","position":4,"item":{"@type":"WebPage","@id":"https://docs.joinsharkey.org/docs/install/","url":"https://docs.joinsharkey.org/docs/install/","name":"Install"}},{"@type":"ListItem","position":5,"item":{"@id":"https://docs.joinsharkey.org/docs/install/migrate/"}}]},{"@context":"https://schema.org","@graph":[{"@type":"Article","@id":"https://docs.joinsharkey.org/#/schema/article/1","headline":"Migrating from another software","description":"","isPartOf":{"@id":"https://docs.joinsharkey.org/docs/install/migrate/"},"mainEntityOfPage":{"@id":"https://docs.joinsharkey.org/docs/install/migrate/"},"datePublished":"0001-01-01T00:00:00CET","dateModified":"0001-01-01T00:00:00CET","author":{"@id":"https://docs.joinsharkey.org/#/schema/person/2"},"publisher":{"@id":"https://docs.joinsharkey.org/#/schema/organization/1"},"image":{"@id":"https://docs.joinsharkey.org/docs/install/migrate/#/schema/image/2"}}]},{"@context":"https://schema.org","@graph":[{"@type":"Person","@id":"https://docs.joinsharkey.org/#/schema/person/2","name":"Henk Verlinde","sameAs":["https://twitter.com/henkverlinde","https://www.linkedin.com/in/henkverlinde/","https://github.com/h-enk"]}]},{"@context":"https://schema.org","@graph":[{"@type":"ImageObject","@id":"https://docs.joinsharkey.org/docs/install/migrate/#/schema/image/2","url":"https://docs.joinsharkey.org/doks.png","contentUrl":"https://docs.joinsharkey.org/doks.png","caption":"Migrating from another software"}]}]}</script><meta name=theme-color content="#fff"><link rel=icon href=https://docs.joinsharkey.org/favicon.ico sizes=any><link rel=apple-touch-icon sizes=180x180 href=https://docs.joinsharkey.org/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://docs.joinsharkey.org/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://docs.joinsharkey.org/favicon-16x16.png><link rel=manifest crossorigin=use-credentials href=https://docs.joinsharkey.org/site.webmanifest></head><body class="docs single"><div class=sticky-top><div class=header-bar></div><header class="navbar navbar-expand-lg navbar-light doks-navbar"><nav class="container-xxl flex-wrap flex-lg-nowrap" aria-label="Main navigation"><a class="navbar-brand order-0" href=/ aria-label="Sharkey Documentation">Sharkey Documentation</a>
<button class="btn btn-link order-0 ms-auto d-lg-none" type=button data-bs-toggle=offcanvas data-bs-target=#offcanvasExample aria-controls=offcanvasExample><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-more-horizontal"><circle cx="12" cy="12" r="1"/><circle cx="19" cy="12" r="1"/><circle cx="5" cy="12" r="1"/></svg></button><div class="offcanvas offcanvas-start d-lg-none" tabindex=-1 id=offcanvasExample aria-labelledby=offcanvasExampleLabel><div class=header-bar></div><div class=offcanvas-header><h5 class=offcanvas-title id=offcanvasExampleLabel>Browse docs</h5><button type=button class=btn-close data-bs-dismiss=offcanvas aria-label=Close></button></div><div class=offcanvas-body><aside class="doks-sidebar mt-n3"><nav id=doks-docs-nav aria-label="Tertiary navigation"><ul class="list-unstyled collapsible-sidebar"><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-cb59b87e00d11222bfd9159d0d23836f aria-expanded=false>
Getting started</button><div class=collapse id=section-cb59b87e00d11222bfd9159d0d23836f><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://docs.joinsharkey.org/docs/getting-started/overview/>Overview</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-349838fb1d851d3e2014b9fe39203275 aria-expanded=true>
Install</button><div class="collapse show" id=section-349838fb1d851d3e2014b9fe39203275><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://docs.joinsharkey.org/docs/install/fresh/>Fresh Installation</a></li><li><a class="docs-link rounded active" href=https://docs.joinsharkey.org/docs/install/migrate/>Migrating from another software</a></li><li><a class="docs-link rounded" href=https://docs.joinsharkey.org/docs/install/faqs/>FAQs</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-f5bfbc80051eaa2963538db69f1de363 aria-expanded=false>
Comparsion</button><div class=collapse id=section-f5bfbc80051eaa2963538db69f1de363><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://docs.joinsharkey.org/docs/comparsion/misskey/>Sharkey vs Misskey</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-2b0d4b9f330e2c0f1808e205d59096b0 aria-expanded=false>
Customisation</button><div class=collapse id=section-2b0d4b9f330e2c0f1808e205d59096b0><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://docs.joinsharkey.org/docs/customisation/themes/>Themes</a></li></ul></div></li></ul></nav></aside></div></div><button class="btn btn-menu order-2 d-block d-lg-none" type=button data-bs-toggle=offcanvas data-bs-target=#offcanvasDoks aria-controls=offcanvasDoks aria-label="Open main menu"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg></button><div class="offcanvas offcanvas-end border-0 py-lg-1" tabindex=-1 id=offcanvasDoks data-bs-backdrop=true aria-labelledby=offcanvasDoksLabel><div class="header-bar d-lg-none"></div><div class="offcanvas-header d-lg-none"><h2 class="h5 offcanvas-title ps-2" id=offcanvasDoksLabel><a class=text-dark href=/>Sharkey Documentation</a></h2><button type=button class="btn-close text-reset me-2" data-bs-dismiss=offcanvas aria-label="Close main menu"></button></div><div class="offcanvas-body p-4 p-lg-0"><ul class="nav flex-column flex-lg-row align-items-lg-center mt-2 mt-lg-0 ms-lg-2 me-lg-auto"></ul><hr class="text-black-50 my-4 d-lg-none"><form class="doks-search position-relative flex-grow-1 ms-lg-auto me-lg-2"><input id=search class="form-control is-search" type=search placeholder="Search docs..." aria-label="Search docs..." autocomplete=off><div id=suggestions class="shadow bg-white rounded d-none"></div></form><hr class="text-black-50 my-4 d-lg-none"><ul class="nav flex-column flex-lg-row"><li class=nav-item><a class="nav-link social-link" href=https://git.joinsharkey.org/Sharkey><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 212 212" width="20" height="20"><style>circle,path{fill:none;stroke:#000;stroke-width:15}path{stroke-width:25}.orange{stroke:#f60}.red{stroke:#d40000}</style><g transform="translate(6 6)"><path d="M58 168V70a50 50 0 0150-50h20" class="orange"/><path d="M58 168v-30a50 50 0 0150-50h20" class="red"/><circle cx="142" cy="20" r="18" class="orange"/><circle cx="142" cy="88" r="18" class="red"/><circle cx="58" cy="180" r="18" class="red"/></g></svg><small class="ms-2 d-lg-none">GitHub</small></a></li></ul><hr class="text-black-50 my-4 d-lg-none"><button id=mode class="btn btn-link" type=button aria-label="Toggle user interface mode">
<span class=toggle-dark><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg></span><span class=toggle-light><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></span></button></div></div></nav></header></div><div class=container-xxl><aside class=doks-sidebar><nav id=doks-docs-nav class="collapse d-lg-none" aria-label="Tertiary navigation"><ul class="list-unstyled collapsible-sidebar"><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-cb59b87e00d11222bfd9159d0d23836f aria-expanded=false>
Getting started</button><div class=collapse id=section-cb59b87e00d11222bfd9159d0d23836f><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://docs.joinsharkey.org/docs/getting-started/overview/>Overview</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-349838fb1d851d3e2014b9fe39203275 aria-expanded=true>
Install</button><div class="collapse show" id=section-349838fb1d851d3e2014b9fe39203275><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://docs.joinsharkey.org/docs/install/fresh/>Fresh Installation</a></li><li><a class="docs-link rounded active" href=https://docs.joinsharkey.org/docs/install/migrate/>Migrating from another software</a></li><li><a class="docs-link rounded" href=https://docs.joinsharkey.org/docs/install/faqs/>FAQs</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-f5bfbc80051eaa2963538db69f1de363 aria-expanded=false>
Comparsion</button><div class=collapse id=section-f5bfbc80051eaa2963538db69f1de363><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://docs.joinsharkey.org/docs/comparsion/misskey/>Sharkey vs Misskey</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-2b0d4b9f330e2c0f1808e205d59096b0 aria-expanded=false>
Customisation</button><div class=collapse id=section-2b0d4b9f330e2c0f1808e205d59096b0><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://docs.joinsharkey.org/docs/customisation/themes/>Themes</a></li></ul></div></li></ul></nav></aside></div><div class="wrap container-xxl" role=document><div class=content><div class="row flex-xl-nowrap"><div class="col-lg-5 col-xl-4 docs-sidebar d-none d-lg-block"><nav class=docs-links aria-label="Main navigation"><ul class="list-unstyled collapsible-sidebar"><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-cb59b87e00d11222bfd9159d0d23836f aria-expanded=false>
Getting started</button><div class=collapse id=section-cb59b87e00d11222bfd9159d0d23836f><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://docs.joinsharkey.org/docs/getting-started/overview/>Overview</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-349838fb1d851d3e2014b9fe39203275 aria-expanded=true>
Install</button><div class="collapse show" id=section-349838fb1d851d3e2014b9fe39203275><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://docs.joinsharkey.org/docs/install/fresh/>Fresh Installation</a></li><li><a class="docs-link rounded active" href=https://docs.joinsharkey.org/docs/install/migrate/>Migrating from another software</a></li><li><a class="docs-link rounded" href=https://docs.joinsharkey.org/docs/install/faqs/>FAQs</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-f5bfbc80051eaa2963538db69f1de363 aria-expanded=false>
Comparsion</button><div class=collapse id=section-f5bfbc80051eaa2963538db69f1de363><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://docs.joinsharkey.org/docs/comparsion/misskey/>Sharkey vs Misskey</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-2b0d4b9f330e2c0f1808e205d59096b0 aria-expanded=false>
Customisation</button><div class=collapse id=section-2b0d4b9f330e2c0f1808e205d59096b0><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://docs.joinsharkey.org/docs/customisation/themes/>Themes</a></li></ul></div></li></ul></nav></div><nav class="docs-toc d-none d-xl-block col-xl-3" aria-label="Secondary navigation"><div class=d-xl-none><button class="btn btn-outline-primary btn-sm doks-toc-toggle collapsed" type=button data-bs-toggle=collapse data-bs-target=#onThisPage aria-controls=doks-docs-nav aria-expanded=false aria-label="Toggle On this page navigation">
<span>On this page</span>
<span><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" class="doks doks-expand" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Expand</title><polyline points="7 13 12 18 17 13"/><polyline points="7 6 12 11 17 6"/></svg><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" class="doks doks-collapse" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Collapse</title><polyline points="17 11 12 6 7 11"/><polyline points="17 18 12 13 7 18"/></svg></span></button><div class=collapse id=onThisPage><div class="card card-body mt-3 py-1"><div class=page-links><nav id=TableOfContents><ul><li><a href=#from-misskey>From Misskey</a><ul><li><a href=#using-docker>Using Docker</a></li></ul></li><li><a href=#from-firefish>From Firefish</a><ul><li><a href=#using-docker-1>Using Docker</a></li></ul></li></ul></nav></div></div></div></div><div class="page-links d-none d-xl-block"><h3>On this page</h3><nav id=TableOfContents><ul><li><a href=#from-misskey>From Misskey</a><ul><li><a href=#using-docker>Using Docker</a></li></ul></li><li><a href=#from-firefish>From Firefish</a><ul><li><a href=#using-docker-1>Using Docker</a></li></ul></li></ul></nav></div></nav><main class="docs-content col-lg-11 col-xl-9"><h1>Migrating from another software</h1><p class=lead></p><nav class=d-xl-none aria-label="Quaternary navigation"><div class=d-xl-none><button class="btn btn-outline-primary btn-sm doks-toc-toggle collapsed" type=button data-bs-toggle=collapse data-bs-target=#onThisPage aria-controls=doks-docs-nav aria-expanded=false aria-label="Toggle On this page navigation">
<span>On this page</span>
<span><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" class="doks doks-expand" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Expand</title><polyline points="7 13 12 18 17 13"/><polyline points="7 6 12 11 17 6"/></svg><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" class="doks doks-collapse" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Collapse</title><polyline points="17 11 12 6 7 11"/><polyline points="17 18 12 13 7 18"/></svg></span></button><div class=collapse id=onThisPage><div class="card card-body mt-3 py-1"><div class=page-links><nav id=TableOfContents><ul><li><a href=#from-misskey>From Misskey</a><ul><li><a href=#using-docker>Using Docker</a></li></ul></li><li><a href=#from-firefish>From Firefish</a><ul><li><a href=#using-docker-1>Using Docker</a></li></ul></li></ul></nav></div></div></div></div><div class="page-links d-none d-xl-block"><h3>On this page</h3><nav id=TableOfContents><ul><li><a href=#from-misskey>From Misskey</a><ul><li><a href=#using-docker>Using Docker</a></li></ul></li><li><a href=#from-firefish>From Firefish</a><ul><li><a href=#using-docker-1>Using Docker</a></li></ul></li></ul></nav></div></nav><h2 id=from-misskey>From Misskey <a href=#from-misskey class=anchor aria-hidden=true>#</a></h2><p>Let&rsquo;s say you have a working Misskey, running as user <code>misskey</code> from
<code>/home/misskey/misskey</code>.</p><p>Migrating to Sharkey is the same as updating to a newer Misskey
version:</p><pre><code class=language-shell>sudo -u misskey -i
cd misskey
git remote rename origin misskey
git remote add origin https://git.joinsharkey.org/Sharkey/Sharkey.git
git remote update -p
git checkout -b stable --track origin/stable
git pull --recurse-submodules
pnpm install --frozen-lockfile
pnpm run build
pnpm run migrate
</code></pre><p>Then you can restart your service.</p><p>If you see weirdness like service not starting, or missing labels in
the web UI, you should first make sure the build worked (check all the
error messages!), then try building again from scratch:</p><pre><code class=language-shell>pnpm run clean-all
pnpm install --frozen-lockfile
pnpm run build
pnpm run migrate
</code></pre><p>Also, clear your browser&rsquo;s cache and local storage (this will log your
browser out of Misskey/Sharkey).</p><h3 id=using-docker>Using Docker <a href=#using-docker class=anchor aria-hidden=true>#</a></h3><p>If you are using the <code>docker-compose.yml</code> file from Misskey which builds locally follow these steps:</p><pre><code class=language-shell>git remote rename origin misskey
git remote add origin https://git.joinsharkey.org/Sharkey/Sharkey.git
git remote update -p
git checkout -b stable --track origin/stable
git pull --recurse-submodules
pnpm install --frozen-lockfile
sudo docker compose build
</code></pre><h2 id=from-firefish>From Firefish <a href=#from-firefish class=anchor aria-hidden=true>#</a></h2><p>This guide was only tested on a Firefish 1.0.5-RC instance: other
versions and instances may differ quite a lot from the one we used,
esspecially if you have custom patches applied.</p><p>If any of the steps fails, especially SQL queries, seek help from us
<a href=https://matrix.to/#/#sharkey-support:shourai.de>via Matrix</a> or
<a href=https://discord.gg/8hF6pMVWja>Discord</a>. Do <em>not</em> try fixing things
in the DB yourself unless you <em>really</em> know what you are doing.</p><p>Before you begin, please take a backup of your database. While you&rsquo;re
there, make sure you know how to restore from that backup! Using the
<code>plain</code> format for <code>pg_dump</code> is probably the simplest way.</p><p>It&rsquo;s a good idea to have a separate backup of your list of silenced
instances and of your <code>user</code> table.</p><h3 id=using-docker-1>Using Docker <a href=#using-docker-1 class=anchor aria-hidden=true>#</a></h3><p>Stop / shut down the entire stack: PostgreSQL, Redis / KeyDB /
DragonflyDB, Sonic / ElasticSearch / MeiliSearch, Firefish
itself. Stop all of it.</p><p>Edit you docker compose and replace the Firefish image with
<code>ghcr.io/transfem-org/sharkey:stable</code></p><p>If you use Sonic or ElasticSearch replace that section of the Docker
Compose with the following, as Sharkey currently only supports
meilisearch:</p><pre><code class=language-yaml>meilisearch:
    restart: always
    image: getmeili/meilisearch:v1.3.4
    environment:
      - MEILI_NO_ANALYTICS=true
      - MEILI_ENV=production
    env_file:
      - .config/meilisearch.env
    networks:
      - calcnet # &lt;-- Use whatever network name is used in the docker compose here
    volumes:
      - ./meili_data:/meili_data # &lt;--- make sure to replace the volume with one that fits your existing docker compose
</code></pre><p>If you use DragonflyDB replace it with Redis or KeyDB, as Sharkey
currently does not support DragonflyDB. To do this replace the section
in the docker compose with the following:</p><pre><code class=language-yaml>redis:
    restart: always
    image: redis:7-alpine
    networks:
      - calcnet # &lt;-- Use whatever network name is used in the docker compose here
    volumes:
      - ./redis:/data # &lt;-- Make sure to replace the volume with the one used in your firefish docker compose
    healthcheck:
      test: &quot;redis-cli ping&quot;
      interval: 5s
      retries: 20
</code></pre><p>Backup your firefish config and replace it with the <a href=https://git.joinsharkey.org/Sharkey/Sharkey/raw/branch/stable/.config/example.yml>default
sharkey
one</a></p><p>Edit the config inline with your instance settings. Make sure to use
the same <code>db</code> & <code>redis</code> settings as in your Firefish config.</p><p>Now is the time to <em>backup</em> your database and Redis volumes!</p><p>Firefish&rsquo;s docker-compose uses PostgreSQL version 12. We strongly
recommend upgrading to 15 or 16. You can do this by making a new db
volume, starting the newer PostgreSQL on it, and importing the data
from the backup you just made. Refer to <a href=https://www.postgresql.org/docs/current/backup-dump.html>the PostgreSQL
documentation</a>.</p><p>Make sure to update the <em>mount paths</em> for volumes of the Sharkey
container from <code>/firefish/</code> to <code>/sharkey/</code> (so your existing volumes
will show up at the new path, inside the container).</p><p>Now start <em>only</em> the database with <code>docker compose up -d db</code> (instead
of <code>db</code>, you may need to use whatever name is set for the service in
your docker compose config), and start a <code>psql</code> shell with <code>docker exec -it db psql -U firefish -d firefish</code> (replace <code>db</code> as before, and
<code>-U firefish -d firefish</code> with the database user and database name,
respectively, if they&rsquo;re different from <code>firefish</code>).</p><p>You should now be connected to your Firefish database. We need to
massage it into shape so that Sharkey database migrations will
work. The following series of SQL queries / commands should do it, but
please read the comments and pay attention to the results after each
query!</p><pre><code class=language-sql>-- start a transaction, so we won't leave the db in a halfway state if
-- things go wrong
BEGIN;

-- we need to add back some columns that Firefish removed, but that
-- Sharkey migrations expect
ALTER TABLE &quot;user_profile&quot; ADD &quot;integrations&quot; JSONB NOT NULL DEFAULT '{}';
ALTER TABLE &quot;meta&quot; ADD &quot;twitterConsumerSecret&quot; VARCHAR(128);
ALTER TABLE &quot;meta&quot; ADD &quot;twitterConsumerKey&quot; VARCHAR(128);
ALTER TABLE &quot;meta&quot; ADD &quot;enableTwitterIntegration&quot; BOOLEAN NOT NULL DEFAULT false;
ALTER TABLE &quot;meta&quot; ADD &quot;enableGithubIntegration&quot; BOOLEAN NOT NULL DEFAULT false;
ALTER TABLE &quot;meta&quot; ADD &quot;githubClientId&quot; VARCHAR(128);
ALTER TABLE &quot;meta&quot; ADD &quot;githubClientSecret&quot; VARCHAR(128);
ALTER TABLE &quot;meta&quot; ADD &quot;enableDiscordIntegration&quot; BOOLEAN NOT NULL DEFAULT false;
ALTER TABLE &quot;meta&quot; ADD &quot;discordClientId&quot; VARCHAR(128);
ALTER TABLE &quot;meta&quot; ADD &quot;discordClientSecret&quot; VARCHAR(128);

-- also an extra table, for the same reasons
CREATE TABLE antenna_note();

-- move aside some FireFish columns; Sharkey migrations will
-- re-create them; we don't `DROP` them because we want to keep the data
ALTER TABLE &quot;user&quot; RENAME COLUMN &quot;movedToUri&quot; TO &quot;ff_movedToUri&quot;;
ALTER TABLE &quot;user&quot; RENAME COLUMN &quot;alsoKnownAs&quot; TO &quot;ff_alsoKnownAs&quot;;
ALTER TABLE &quot;user&quot; RENAME COLUMN &quot;isIndexable&quot; TO &quot;ff_isIndexable&quot;;
ALTER TABLE &quot;user&quot; RENAME COLUMN &quot;speakAsCat&quot; TO &quot;ff_speakAsCat&quot;;
ALTER TABLE &quot;user_profile&quot; RENAME COLUMN &quot;preventAiLearning&quot; TO &quot;ff_preventAiLearning&quot;;
ALTER TABLE &quot;meta&quot; RENAME COLUMN &quot;silencedHosts&quot; TO &quot;ff_silencedHosts&quot;;

-- this column was added by both Firefish and Misskey, but with
-- different names, let's fix it
ALTER TABLE &quot;meta&quot; RENAME COLUMN &quot;ToSUrl&quot; TO &quot;termsOfServiceUrl&quot;;

-- update antenna types, this is only needed on some instances but
-- recommend to run anyway
--
-- this *removes* any antennas of types not supported by Sharkey!
CREATE TYPE public.new_antenna_src_enum AS ENUM ('home', 'all', 'list');
ALTER TABLE antenna ADD COLUMN new_src public.new_antenna_src_enum;
DELETE FROM antenna WHERE src NOT IN ('home', 'all', 'list');
ALTER TABLE antenna DROP COLUMN src;
ALTER TABLE antenna RENAME COLUMN new_src TO src;
DROP TYPE public.antenna_src_enum;
ALTER TYPE new_antenna_src_enum RENAME TO antenna_src_enum;

-- optional but recommended: delete all empty moderation log entries
DELETE FROM moderation_log WHERE info = '{}';

-- only needed on some instances, run this if
-- `\dT+ user_profile_mutingnotificationtypes_enum`
-- does not show `note` in the &quot;elements&quot; section
ALTER TYPE &quot;public&quot;.&quot;user_profile_mutingnotificationtypes_enum&quot; ADD VALUE 'note';
</code></pre><p>If everything worked and you saw no errors, you can run <code>COMMIT;</code> in
that same <code>psql</code> shell, to commit all the changes, then close that
shell. Again, if anything went wrong, come talk to us on
<a href=https://matrix.to/#/#sharkey-support:shourai.de>Matrix</a> or
<a href=https://discord.gg/8hF6pMVWja>Discord</a>!</p><p>Start Sharkey, and let it run all its migrations. Once that&rsquo;s done,
and Starkey says it&rsquo;s listening, stop Sharkey but keep the database
running.</p><p>Open another <code>psql</code> shell like before (<code>docker exec -it db psql -U firefish -d firefish</code>, replacing things as before). We need another
small pass of massaging.</p><pre><code class=language-sql>BEGIN;

-- all existing users are approved, because Firefish doesn't have a
-- concept of approvals
UPDATE &quot;user&quot; SET approved = true;

-- now we put back the data we moved aside
UPDATE &quot;user&quot; SET &quot;movedToUri&quot; = &quot;ff_movedToUri&quot; WHERE &quot;ff_movedToUri&quot; IS NOT NULL;
UPDATE &quot;user&quot; SET &quot;alsoKnownAs&quot; = &quot;ff_alsoKnownAs&quot; WHERE &quot;ff_alsoKnownAs&quot; IS NOT NULL;
UPDATE &quot;user&quot; SET &quot;noindex&quot; = NOT (COALESCE(&quot;ff_isIndexable&quot;, true));
UPDATE &quot;user&quot; SET &quot;speakAsCat&quot; = COALESCE(&quot;ff_speakAsCat&quot;, false);
UPDATE &quot;user_profile&quot; SET &quot;preventAiLearning&quot; = COALESCE(&quot;ff_preventAiLearning&quot;, true);
UPDATE &quot;meta&quot; SET &quot;silencedHosts&quot; = COALESCE(&quot;ff_silencedHosts&quot;,'{}');

ALTER TABLE &quot;user&quot; DROP COLUMN &quot;ff_movedToUri&quot;;
ALTER TABLE &quot;user&quot; DROP COLUMN &quot;ff_alsoKnownAs&quot;;
ALTER TABLE &quot;user&quot; DROP COLUMN &quot;ff_isIndexable&quot;;
ALTER TABLE &quot;user&quot; DROP COLUMN &quot;ff_speakAsCat&quot;;
ALTER TABLE &quot;user_profile&quot; DROP COLUMN &quot;ff_preventAiLearning&quot;;
ALTER TABLE &quot;meta&quot; DROP COLUMN &quot;ff_silencedHosts&quot;;

</code></pre><p>If everything worked and you saw no errors, you can run <code>COMMIT;</code> in
that same <code>psql</code> shell, to commit all the changes, then close that
shell. Again, if anything went wrong, come talk to us on
<a href=https://matrix.to/#/#sharkey-support:shourai.de>Matrix</a> or
<a href=https://discord.gg/8hF6pMVWja>Discord</a>!</p><p>Start everything up again, you should see no errors in the logs.</p><p>Log in as an administrator, and go to the control panel.
If you use an object store such as S3, double-check your settings
(it&rsquo;s possible, for example, that the URL now looks like
<code>https://https://yourdomain.com</code>, fix it). If you want your users to
be able to search notes, you must enable it via the &ldquo;roles&rdquo; system.</p><p>Congratulations, you&rsquo;re now running Sharkey!</p><div class="page-footer-meta d-flex flex-column flex-md-row justify-content-between"></div><div class="docs-navigation d-flex justify-content-between"><a href=/docs/install/fresh/><div class="card my-1"><div class="card-body py-2">&larr; Fresh Installation</div></div></a><a class=ms-auto href=/docs/comparsion/misskey/><div class="card my-1"><div class="card-body py-2">Sharkey vs Misskey &rarr;</div></div></a></div></main></div></div></div><footer class="footer text-muted"><div class=container-xxl><div class=row><div class="col-lg-8 order-last order-lg-first"><ul class=list-inline><li class=list-inline-item>Powered by <a class=text-muted href=https://pages.github.com/>Github Pages</a>, <a class=text-muted href=https://gohugo.io/>Hugo</a>, and <a class=text-muted href=https://getdoks.org/>Doks</a></li></ul></div><div class="col-lg-8 order-first order-lg-last text-lg-end"><ul class=list-inline></ul></div></div></div></footer><script src=/js/bootstrap.min.223fd2b247a18dd9421f5eac2b8f740a338445314a3282ea82752d0b792e51c8d367c12fd27ceb7c011214399deee96a6fdfc51943f9bbef1aa079653d1e4bdc.js integrity="sha512-Ij/SskehjdlCH16sK490CjOERTFKMoLqgnUtC3kuUcjTZ8Ev0nzrfAESFDmd7ulqb9/FGUP5u+8aoHllPR5L3A==" crossorigin=anonymous defer></script>
<script src=/js/highlight.min.8b2d7ddd72ba2c88d5107387eb3b66b90f1f864fd5afef6aed284425efb5919a9bc092f653f2985a205b85b0a158f70b460643ba2b71ccf7d3c1c107c3a4b609.js integrity="sha512-iy193XK6LIjVEHOH6ztmuQ8fhk/Vr+9q7ShEJe+1kZqbwJL2U/KYWiBbhbChWPcLRgZDuitxzPfTwcEHw6S2CQ==" crossorigin=anonymous defer></script>
<script src=/main.min.57d9a84956f7d60008c47938c7fdd2f75e8618ff1d09c5a5e2b32f91debaf7681f7ceca8b51aded60067c2136172134a91ebc0674487c76a04e3244d927ebdde.js integrity="sha512-V9moSVb31gAIxHk4x/3S916GGP8dCcWl4rMvkd6692gffOyotRre1gBnwhNhchNKkevAZ0SHx2oE4yRNkn693g==" crossorigin=anonymous defer></script>
<script src=https://docs.joinsharkey.org/index.min.914a4f417b0dc4ee9148026cecb2910e2f347442f0e4872c2a5a3dfba76f046828211c725754ea0fe74e13aad392f7d2c1813ed94f796a3e8fa32e4d6e168d11.js integrity="sha512-kUpPQXsNxO6RSAJs7LKRDi80dELw5IcsKlo9+6dvBGgoIRxyV1TqD+dOE6rTkvfSwYE+2U95aj6Poy5NbhaNEQ==" crossorigin=anonymous defer></script></body></html>